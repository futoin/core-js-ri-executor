!function(a){"function"==typeof define&&define.amd?define(["futoin-asyncsteps","futoin-invoker"],a):"object"==typeof exports?module.exports=a(require("futoin-asyncsteps"),require("futoin-invoker")):this.FutoInExecutor=a($as,FutoInInvoker)}(function(a,b){function c(a){var b=c.cache[a];if(!b){var d={};b=c.cache[a]={id:a,exports:d},c.modules[a].call(d,b,d)}return b.exports}var d=this;return c.cache=[],c.modules=[function(a){"use strict";var b=c(48),d=c(54),e=c(27),f=c(25),g=c(61),h=window,i=c(3),j=c(1),k=c(5),l=c(4),m=function(a,b){j.call(this,a),this._event_origin=b.origin,this._event_source=b.source,this._last_used=g(),this._is_secure_channel=!0},n=b(j.prototype);m.prototype=n,n.type=function(){return"BROWSER"},n.isStateful=function(){return!0},n._getPerformRequest=function(){var a=this._event_origin,b=this._event_source,c=this._executor._reverse_requests,d=this._executor._msg_sniffer;return function(e,f,g){e.add(function(e){var h="S"+c.rid++;if(g.rid=h,f.expect_response){var i=c.sentreqs;i[h]={reqas:e,evt_origin:a,evt_source:b},e.setCancel(function(){delete i[h]})}d(a,g,!1),b.postMessage(g,a)})}};var o={OPT_CONNECT_TIMEOUT:"connectTimeout",OPT_ALLOWED_ORIGINS:"allowedOrigins"},p=function(a,b){i.call(this,a,b),b=b||{},this._msg_sniffer=b.messageSniffer||function(){},this._contexts=[],this._reverse_requests={rid:1,sentreqs:{}};var c=this,d=b.allowedOrigins||{};d instanceof Array&&(d=e(d,d)),this.allowed_origins=d;var f=b.connectTimeout||600,j=function(){for(var a=c._contexts,b=g()-f,d=a.length-1;d>=0;--d){var e=a[d];e._last_used<b&&(e._cleanup(),a.splice(d,1))}setTimeout(j,1e3*f)};j(),this._event_listener=function(a){c.handleMessage(a)},h.addEventListener("message",this._event_listener)},q=b(i.prototype);p.prototype=q,d(p,o,q.Const),d(q,o),q.allowed_origins=null,q.handleMessage=function(a){this._msg_sniffer(a,a.data,!0);var b=a.data,c=a.source,d=a.origin;if("object"==typeof b&&"rid"in b){var e=b.rid;if(!("f"in b)&&"S"===e.charAt(0)){var h=this._reverse_requests.sentreqs,i=h[e];return i&&c===i.evt_source&&d===i.evt_origin&&(i.reqas.success(b,"application/futoin+json"),delete h[e]),void(a.stopPropagation&&a.stopPropagation())}if("f"in b&&"C"===e.charAt(0)&&d in this.allowed_origins){for(var j=null,n=this._contexts,o=0,p=n.length;p>o;++o){var q=n[o];if(q._event_source===c&&q._event_origin===d){j=q;break}}j?j._last_used=g():(j=new m(this,a),n.push(j));var r=new k("LOCAL",c,d),s=new l(this,b),t=s.info;t[s.INFO_CHANNEL_CONTEXT]=j,t[s.INFO_CLIENT_ADDR]=r,t[s.INFO_SECURE_CHANNEL]=this._is_secure_channel;var u=this,v=f();v.state.reqinfo=s,s._as=v;var w=function(b){s.cancelAfter(0),s._as=null;var c={e:"InternalError",rid:e};u._msg_sniffer(a,c,!1),j._event_source.postMessage(c,j._event_origin)};v.add(function(b){b.setCancel(w),u.process(b),b.add(function(b){var c=t[s.INFO_RAW_RESPONSE];s.cancelAfter(0),s._as=null,null!==c&&(u._msg_sniffer(a,c,!1),j._event_source.postMessage(c,j._event_origin))})}).execute(),a.stopPropagation&&a.stopPropagation()}}},q.close=function(a){h.removeEventListener("message",this._event_listener),a&&a()},a.exports=p},function(a){"use strict";var b=function(a){this._executor=a,this._ifaces={},this.state=function(){return this.state}},c={_user_info:null,_ifaces:null,state:null,type:function(){},isStateful:function(){return!1},onInvokerAbort:function(a,b){},_openRawInput:function(){return null},_openRawOutput:function(){return null},register:function(a,b,c){this.isStateful()||a.error("InvokerError","Not stateful channel"),this._executor.ccm().register(a,null,b,this._getPerformRequest(),null,c);var d=this;a.add(function(a,c,e){c.secure_channel=d._executor._is_secure_channel,d._ifaces[b]=e})},iface:function(a){return this._ifaces[a]},_getPerformRequest:function(){throw Error("NotImplemented")},_cleanup:function(){delete this._executor,delete this._ifaces,delete this.state}};b.prototype=c,a.exports=b},function(a){"use strict";var b=function(a,b,c){this._ccm=a,this._base_id=b,this._sequence_id=c},c={baseID:function(){return this._base_id},sequenceID:function(){return this._sequence_id},encrypt:function(a,b){},decrypt:function(a,b){}};b.prototype=c,a.exports=b},function(a){"use strict";var b=c(54),d=c(26),e=d.FutoInError,f=c(25),g=c(10),h=c(48),i=c(3),j=c(1),k=c(5),l=c(4),m=c(6),n=function(a){j.call(this,a)},o=h(j.prototype);n.prototype=o,o.type=function(){return"CALLBACK"},o.isStateful=function(){return!0};var p=function(a,b){j.call(this,a),this._invoker_executor=b},q=h(j.prototype);p.prototype=q,q.type=function(){return"INTERNAL"},q.isStateful=function(){return!0},q._getPerformRequest=function(){var a=this._invoker_executor;return a?function(b,c,d){a.onInternalRequest(b,c.info,d)}:this._commError},q._commError=function(a){a.error(e.CommError,"No Invoker's Executor for internal call")};var r={OPT_VAULT:"vault",OPT_SPEC_DIRS:d.AdvancedCCM.OPT_SPEC_DIRS,OPT_PROD_MODE:d.AdvancedCCM.OPT_PROD_MODE,OPT_MSG_SNIFFER:d.SimpleCCM.OPT_MSG_SNIFFER,OPT_REQUEST_TIMEOT:"reqTimeout",OPT_HEAVY_REQUEST_TIMEOT:"heavyReqTimeout",DEFAULT_REQUEST_TIMEOUT:5e3,DEFAULT_HEAVY_TIMEOUT:6e4,SAFE_PAYLOAD_LIMIT:65536},i=function(a,b){g(this),this._ccm=a,this._ifaces={},this._impls={},b=b||{};var c=b.specDirs;c instanceof Array||(c=[c]),this._specdirs=c,this._dev_checks=!b.prodMode,this._request_timeout=b.reqTimeout||this.DEFAULT_REQUEST_TIMEOUT,this._heavy_timeout=b.heavyReqTimeout||this.DEFAULT_HEAVY_TIMEOUT,this._byteLength="undefined"!=typeof Buffer&&Buffer.byteLength?Buffer.byteLength:function(a){return a.length}},s={_ccm:null,_ifaces:null,_impls:null,_specdirs:null,_dev_checks:!1,ccm:function(){return this._ccm},register:function(a,b,c,f){var g=b.match(d.SpecTools._ifacever_pattern);null===g&&a.error(e.InternalError,"Invalid ifacever");var h=g[1],i=g[4],j=g[5],k=g[6],l=this._ifaces;h in l&&j in l[h]&&a.error(e.InternalError,"Already registered");var m={iface:h,version:i,mjrver:j,mnrver:k};d.SpecTools.loadIface(a,m,f||this._specdirs);var n=this;a.add(function(a){h in l||(l[h]={},n._impls[h]={}),l[h][j]=m,n._impls[h][j]=c;for(var b=0;b<m.inherits.length;++b){var f=m.inherits[b].match(d.SpecTools._ifacever_pattern),g=f[1],i=f[4],k=f[5],o=f[6],p={iface:g,version:i,mjrver:k,mnrver:o,derived:m};g in l&&k in l[g]&&(delete l[h][j],a.error(e.InternalError,"Conflict with inherited interfaces")),g in l||(l[g]={}),l[g][k]=p}})},onEndpointRequest:function(a,b,c){var d=this,e=new l(this,b),g=new n(this),h=new k(g.type(),null,a.regname),i=e.info;i[e.INFO_CHANNEL_CONTEXT]=g,i[e.INFO_CLIENT_ADDR]=h,i[e.INFO_SECURE_CHANNEL]=a.secure_channel;var j=f();e._as=j,j.add(function(a){a.setCancel(function(a){var b={rid:e._rawreq.rid,e:"InternalError"};e.cancelAfter(0),e._as=null,c(b)}),a.state.reqinfo=e,d.process(a),a.add(function(a){var b=i[e.INFO_RAW_RESPONSE];e.cancelAfter(0),e._as=null,null!==b&&c(b)})},function(a,b){d.emit("notExpected",b,a.state.error_info),e.cancelAfter(0),e._as=null}).execute()},onInternalRequest:function(a,b,c,g,h){var i=b._server_executor_context;i||(i=new p(this,b.options.executor),b._server_executor_context=i);var j=this,m=new l(this,c),n=new k(i.type(),null,null),o=m.info;o[m.INFO_CHANNEL_CONTEXT]=i,o[m.INFO_CLIENT_ADDR]=n,o[m.INFO_SECURE_CHANNEL]=!0,g&&(o[m.INFO_HAVE_RAW_UPLOAD]=!0,m._rawinp=g),h&&(m._rawout=h),a.add(function(a){var b=f();m._as=b,b.add(function(b){b.setCancel(function(b){if(m.cancelAfter(0),m._as=null,!b.state._orig_as_cancel)try{a.error(e.InternalError,"Executor canceled")}catch(c){}}),b.state.reqinfo=m,j.process(b),b.add(function(b){var c=o[m.INFO_RAW_RESPONSE];m.cancelAfter(0),m._as=null,null!==c&&a.success(c,d.SimpleCCM.FUTOIN_CONTENT_TYPE)})},function(a,b){j.emit("notExpected",b,a.state.error_info),m.cancelAfter(0),m._as=null}).execute(),a.setCancel(function(a){b.state._orig_as_cancel=!0,b.cancel()})})},process:function(a){var c=a.state.reqinfo;(!c||"_func_info"in c.info)&&a.error(e.InternalError,"Invalid process() invocation");var f=this;a.add(function(a){var d=c.info,g=d[c.INFO_RAW_REQUEST];f.emit("request",c,g),f._getInfo(a,c),c.cancelAfter(d._func_info.heavy?f._heavy_timeout:f._request_timeout),f._checkParams(a,c);var h=g.sec;h&&(h=h.split(":"),"-hmac"===h[0]?f._checkAuthHMAC(a,c,h[1],h[2],h[3]):f._checkBasicAuth(a,c,h)),a.add(function(a){f._checkConstraints(a,c);var g=d._func,h=f._getImpl(a,c);g in h||a.error(e.InternalError,"Missing function implementation");var i=h[g](a,c);i&&b(c.result(),i)}),a.add(function(a,d){d&&b(c.result(),d),f._checkResponse(a,c),a.success(c)})},function(a,b){var c=a.state.reqinfo,g=c.info,h=a.state.error_info;b in d.SpecTools.standard_errors||g._func_info&&b in g._func_info["throws"]||(f.emit("notExpected",b,h),b=e.InternalError,h="Not expected error");var i=c.info[c.INFO_RAW_RESPONSE];i.e=b,delete i.r,h&&(i.edesc=h),a.success(c)}).add(function(a,b){f._signResponse(a,b)})},checkAccess:function(a,b){a.error(e.NotImplemented,"Access Control is not supported yet")},initFromCache:function(a){a.error(e.NotImplemented,"Caching is not supported yet")},cacheInit:function(a){a.error(e.NotImplemented,"Caching is not supported yet")},_getInfo:function(a,b){var c=b.info,d=c[b.INFO_RAW_REQUEST].f;"string"!=typeof d&&a.error(e.InvalidRequest,"Missing req.f"),d=d.split(":"),3!==d.length&&a.error(e.InvalidRequest,"Invalid req.f");var f=d[0],g=d[2],h=d[1].split(".");2!==h.length&&a.error(e.InvalidRequest,"Invalid req.f (version)"),f in this._ifaces||a.error(e.UnknownInterface,"Unknown Interface");var i=h[0],j=h[1];i in this._ifaces[f]||a.error(e.NotSupportedVersion,"Different major version");var k=this._ifaces[f][i];k.mnrver<j&&a.error(e.NotSupportedVersion,"Iface version is too old"),"derived"in k&&(k=k.derived),g in k.funcs||a.error(e.InvalidRequest,"Not defined interface function");var l=k.funcs[g];c._iface_info=k,c._func=g,c._func_info=l,l.rawresult&&(c[b.INFO_HAVE_RAW_RESULT]=!0)},_checkBasicAuth:function(a,b,c){var d=this;a.add(function(a){var e=d._ccm.iface("#basicauth"),f=b.info;e.call(a,"auth",{user:c[0],pwd:c[1],client_addr:f[b.INFO_CLIENT_ADDR].asString(),is_secure:f[b.INFO_SECURE_CHANNEL]}),a.add(function(a,c){f[b.INFO_USER_INFO]=new m(d._ccm,c.local_id,c.global_id,c.details),f[b.INFO_SECURITY_LEVEL]=l.SL_INFO})},function(a,b){a.success()})},_checkAuthHMAC:function(a,b,c,d,f){var g=this;a.add(function(a){var e=g._ccm.iface("#basicauth"),i=b.info,j=h(b.info[b.INFO_RAW_REQUEST]);delete j.sec,e.call(a,"checkHMAC",{msg:j,user:c,algo:d,sig:f,client_addr:i[b.INFO_CLIENT_ADDR].asString(),is_secure:i[b.INFO_SECURE_CHANNEL]}),a.add(function(a,e){i[b.INFO_USER_INFO]=new m(g._ccm,e.local_id,e.global_id,e.details),i[b.INFO_SECURITY_LEVEL]=l.SL_INFO,i._hmac_algo=d,i._hmac_user=c})},function(a,b){a.error(e.SecurityError,"Signature Verification Failed")})},_checkConstraints:function(a,b){var c=b.info,d=c._iface_info.constraints;"SecureChannel"in d&&!c[b.INFO_SECURE_CHANNEL]&&a.error(e.SecurityError,"Insecure channel"),"MessageSignature"in d&&!c[b.INFO_DERIVED_KEY]&&!c._hmac_user&&a.error(e.SecurityError,"Message Signature is required"),"AllowAnonymous"in d||c[b.INFO_USER_INFO]||a.error(e.SecurityError,"Anonymous not allowed");var f=c[b.INFO_CHANNEL_CONTEXT];!("BiDirectChannel"in d)||f&&f.isStateful()||(console.dir(f),console.log(f.isStateful()),a.error(e.InvalidRequest,"Bi-Direct Channel is required"))},_checkParams:function(a,b){var c=b.info,f=c[b.INFO_RAW_REQUEST],g=c._func_info;if(b[b.INFO_HAVE_RAW_UPLOAD]&&!g.rawupload&&a.error(e.InvalidRequest,"Raw upload is not allowed"),"p"in f){var h,i=f.p;for(h in i){h in g.params||a.error(e.InvalidRequest,"Unknown parameter");var j=d.SpecTools.checkParameterType(c._iface_info,c._func,h,i[h]);if(!j){if(c._from_query_string)try{if(i[h]=JSON.parse(i[h]),j=d.SpecTools.checkParameterType(c._iface_info,c._func,h,i[h]))continue}catch(k){}a.error(e.InvalidRequest,"Type mismatch for parameter: "+h)}}for(h in g.params)if(!(h in i)){var l=g.params[h];"default"in l?i[h]=l["default"]:a.error(e.InvalidRequest,"Missing parameter: "+h)}}else Object.keys(g.params).length>0&&a.error(e.InvalidRequest,"Missing parameter (any)")},_getImpl:function(a,b){var c=b.info,d=c._iface_info,f=d.iface,g=d.mjrver,h=this._impls[f][g];return"object"!=typeof h&&("function"==typeof h?h=h(h,this):a.error(e.InternalError,"Invalid implementation type"),"object"!=typeof h&&a.error(e.InternalError,"Implementation does not implement InterfaceImplementation"),this._impls[f][g]=h),h},_checkResponse:function(a,b){if(this._dev_checks){var c=b.info,f=c[b.INFO_RAW_RESPONSE],g=c._func_info;if(g.rawresult)return c[b.INFO_RAW_RESPONSE]=null,void(Object.keys(f.r).length>0&&a.error(e.InternalError,"Raw result is expected"));if(!g.expect_result&&c[b.INFO_RAW_REQUEST].forcersp!==!0)return void(c[b.INFO_RAW_RESPONSE]=null);if(Object.keys(g.result).length>0){var h,i=g.result,j=0;for(h in f.r)h in i||a.error(e.InternalError,"Unknown result variable '"+h+"'"),d.SpecTools.checkResultType(a,c._iface_info,c._func,h,f.r[h]),++j;Object.keys(i).length!==j&&a.error(e.InternalError,"Missing result variables")}else Object.keys(f.r).length>0&&a.error(e.InternalError,"No result variables are expected")}},_signResponse:function(a,b){var c=b.info,d=c[b.INFO_RAW_RESPONSE];if(!d)return void this.emit("response",b,d);if(c[b.INFO_DERIVED_KEY])return void this.emit("response",b,d);if(c._hmac_user){var e=this;return void a.add(function(a){var f=e._ccm.iface("#basicauth");f.call(a,"genHMAC",{msg:d,user:c._hmac_user,algo:c._hmac_algo}),a.add(function(a,c){d.sec=c.sig,e.emit("response",b,d)})},function(a,c){e.emit("response",b,d),a.success()})}this.emit("response",b,d)},close:function(){},packPayloadJSON:function(a){var b=JSON.stringify(a);if(this._byteLength(b,"utf8")>this.SAFE_PAYLOAD_LIMIT)throw this.emit("notExpected",e.InternalError,"Response size has exceeded safety limit"),new Error(e.InternalError);return b}};i.prototype=s,b(i,r),b(s,r),s.Const=r,a.exports=i},function(a){"use strict";var b=c(54),d=c(61),e=c(25),f={SL_ANONYMOUS:"Anonymous",SL_INFO:"Info",SL_SAFEOPS:"SafeOps",SL_PRIVLEGED_OPS:"PrivilegedOps",SL_EXCEPTIONAL_OPS:"ExceptionalOps",INFO_X509_CN:"X509_CN",INFO_PUBKEY:"PUBKEY",INFO_CLIENT_ADDR:"CLIENT_ADDR",INFO_SECURE_CHANNEL:"SECURE_CHANNEL",INFO_REQUEST_TIME_FLOAT:"REQUEST_TIME_FLOAT",INFO_SECURITY_LEVEL:"SECURITY_LEVEL",INFO_USER_INFO:"USER_INFO",INFO_RAW_REQUEST:"RAW_REQUEST",INFO_RAW_RESPONSE:"RAW_RESPONSE",INFO_DERIVED_KEY:"DERIVED_KEY",INFO_HAVE_RAW_UPLOAD:"HAVE_RAW_UPLOAD",INFO_HAVE_RAW_RESULT:"HAVE_RAW_RESULT",INFO_CHANNEL_CONTEXT:"CHANNEL_CONTEXT"},g=function(a,b){this._executor=a,"string"==typeof b&&(b=JSON.parse(b)),this._rawreq=b;var c={r:{}};"rid"in b&&(c.rid=b.rid),this._rawrsp=c;var e=function(){return this.info};this.info=e,e[this.INFO_X509_CN]=null,e[this.INFO_PUBKEY]=null,e[this.INFO_CLIENT_ADDR]=null,e[this.INFO_SECURE_CHANNEL]=!1,e[this.INFO_SECURITY_LEVEL]=this.SL_ANONYMOUS,e[this.INFO_USER_INFO]=null,e[this.INFO_RAW_REQUEST]=b,e[this.INFO_RAW_RESPONSE]=c,e[this.INFO_DERIVED_KEY]=null,e[this.INFO_HAVE_RAW_UPLOAD]=!1,e[this.INFO_HAVE_RAW_RESULT]=!1,e[this.INFO_CHANNEL_CONTEXT]=null,e[this.INFO_REQUEST_TIME_FLOAT]=d()};b(g,f);var h=f;h._rawinp=null,h._rawout=null,h.params=function(){return this._rawreq.p},h.result=function(){return this._rawrsp.r},h.rawInput=function(){var a=this._rawinp;if(!a&&(this.info[this.INFO_HAVE_RAW_UPLOAD]&&null!==this.info[this.INFO_CHANNEL_CONTEXT]&&(a=this.info[this.INFO_CHANNEL_CONTEXT]._openRawInput(),this._rawinp=a),!a))throw new Error("RawInputError");return a},h.rawOutput=function(){var a=this._rawout;if(!a&&(this.info[this.INFO_HAVE_RAW_RESULT]&&null!==this.info[this.INFO_CHANNEL_CONTEXT]&&(a=this.info[this.INFO_CHANNEL_CONTEXT]._openRawOutput(),this._rawout=a),!a))throw new Error("RawOutputError");return a},h.executor=function(){return this._executor},h.channel=function(){return this.info[this.INFO_CHANNEL_CONTEXT]},h.cancelAfter=function(a){if(this._cancelAfter&&(e.AsyncTool.cancelCall(this._cancelAfter),this._cancelAfter=null),a>0&&this._as){var b=this;this._cancelAfter=e.AsyncTool.callLater(function(){b._as.cancel()},a)}},g.prototype=h,a.exports=g},function(a){"use strict";var b=function(a,b,c){null===a&&(a="string"!=typeof b?"LOCAL":b.match(/^([0-9]{1,3}\.){3}[0-9]{1,3}$/)?"IPv4":"IPv6"),this.type=a,this.host=b,this.port=c};b.prototype={host:null,port:null,type:null,asString:function(){return"LOCAL"===this.type?"LOCAL:"+this.port:"IPv6"===this.type?"IPv6:["+this.host+"]:"+this.port:this.type+":"+this.host+":"+this.port}},a.exports=b},function(a){"use strict";var b=c(54),d={INFO_FirstName:"FirstName",INFO_FullName:"FullName",INFO_DateOfBirth:"DateOfBirth",INFO_TimeOfBirth:"TimeOfBirth",INFO_ContactEmail:"ContactEmail",INFO_ContactPhone:"ContactPhone",INFO_HomeAddress:"HomeAddress",INFO_WorkAddress:"WorkAddress",INFO_Citizenship:"Citizenship",INFO_GovernmentRegID:"GovernmentRegID",INFO_AvatarURL:"AvatarURL"},e=function(a,b,c,d){this._ccm=a,this._local_id=b,this._global_id=c,this._details=d};b(e,d);var f=d;f.localID=function(){return this._local_id},f.globalID=function(){return this._global_id},f.details=function(a,b){var c=this._details;return c?void a.add(function(a){a.success(c)}):void a.error("NotImplemented")},e.prototype=f,a.exports=e},function(a){!function(b){"use strict";var d=b.FutoIn||{};if("undefined"==typeof d.Executor){var e=c(8);b.FutoInExecutor=e,d.Executor=e,b.FutoIn=d,b.BrowserExecutor=e.BrowserExecutor,a&&(a.exports=e)}}(window)},function(a,b){"use strict";var d=c(9);b.ChannelContext=c(1),b.DerivedKey=c(2),b.RequestInfo=c(4),b.SourceAddress=c(5),b.UserInfo=c(6);var e=c(3);if(b.Executor=e,b.ClientExecutor=e,d){var f=require;b.NodeExecutor=f("../NodeExecutor")}else b.BrowserExecutor=c(0)},function(a){a.exports=!1;try{a.exports="[object process]"===Object.prototype.toString.call(d.process)}catch(b){}},function(a,b){"use strict";var d,e,f,g,h,i,j,k=c(11),l=c(20),m=Function.prototype.apply,n=Function.prototype.call,o=Object.create,p=Object.defineProperty,q=Object.defineProperties,r=Object.prototype.hasOwnProperty,s={configurable:!0,enumerable:!1,writable:!0};d=function(a,b){var c;return l(b),r.call(this,"__ee__")?c=this.__ee__:(c=s.value=o(null),p(this,"__ee__",s),s.value=null),c[a]?"object"==typeof c[a]?c[a].push(b):c[a]=[c[a],b]:c[a]=b,this},e=function(a,b){var c,e;return l(b),e=this,d.call(this,a,c=function(){f.call(e,a,c),m.call(b,this,arguments)}),c.__eeOnceListener__=b,this},f=function(a,b){var c,d,e,f;if(l(b),!r.call(this,"__ee__"))return this;if(c=this.__ee__,!c[a])return this;if(d=c[a],"object"==typeof d)for(f=0;e=d[f];++f)(e===b||e.__eeOnceListener__===b)&&(2===d.length?c[a]=d[f?0:1]:d.splice(f,1));else(d===b||d.__eeOnceListener__===b)&&delete c[a];return this},g=function(a){var b,c,d,e,f;if(r.call(this,"__ee__")&&(e=this.__ee__[a]))if("object"==typeof e){for(c=arguments.length,f=new Array(c-1),b=1;c>b;++b)f[b-1]=arguments[b];for(e=e.slice(),b=0;d=e[b];++b)m.call(d,this,f)}else switch(arguments.length){case 1:n.call(e,this);break;case 2:n.call(e,this,arguments[1]);break;case 3:n.call(e,this,arguments[1],arguments[2]);break;default:for(c=arguments.length,f=new Array(c-1),b=1;c>b;++b)f[b-1]=arguments[b];m.call(e,this,f)}},h={on:d,once:e,off:f,emit:g},i={on:k(d),once:k(e),off:k(f),emit:k(g)},j=q({},i),a.exports=b=function(a){return null==a?o(j):q(Object(a),i)},b.methods=h},function(a){"use strict";var b,d=c(12),e=c(19),f=c(15),g=c(22);b=a.exports=function(a,b){var c,f,h,i,j;return arguments.length<2||"string"!=typeof a?(i=b,b=a,a=null):i=arguments[2],null==a?(c=h=!0,f=!1):(c=g.call(a,"c"),f=g.call(a,"e"),h=g.call(a,"w")),j={value:b,configurable:c,enumerable:f,writable:h},i?d(e(i),j):j},b.gs=function(a,b,c){var h,i,j,k;return"string"!=typeof a?(j=c,c=b,b=a,a=null):j=arguments[3],null==b?b=void 0:f(b)?null==c?c=void 0:f(c)||(j=c,c=void 0):(j=b,b=c=void 0),null==a?(h=!0,i=!1):(h=g.call(a,"c"),i=g.call(a,"e")),k={get:b,set:c,configurable:h,enumerable:i},j?d(e(j),k):k}},function(a){"use strict";a.exports=c(13)()?Object.assign:c(14)},function(a){"use strict";a.exports=function(){var a,b=Object.assign;return"function"!=typeof b?!1:(a={foo:"raz"},b(a,{bar:"dwa"},{trzy:"trzy"}),a.foo+a.bar+a.trzy==="razdwatrzy")}},function(a){"use strict";var b=c(16),d=c(21),e=Math.max;a.exports=function(a,c){var f,g,h,i=e(arguments.length,2);for(a=Object(d(a)),h=function(b){try{a[b]=c[b]}catch(d){f||(f=d)}},g=1;i>g;++g)c=arguments[g],b(c).forEach(h);if(void 0!==f)throw f;return a}},function(a){"use strict";a.exports=function(a){return"function"==typeof a}},function(a){"use strict";a.exports=c(17)()?Object.keys:c(18)},function(a){"use strict";a.exports=function(){try{return Object.keys("primitive"),!0}catch(a){return!1}}},function(a){"use strict";var b=Object.keys;a.exports=function(a){return b(null==a?a:Object(a))}},function(a){"use strict";var b=Array.prototype.forEach,c=Object.create,d=function(a,b){var c;for(c in a)b[c]=a[c]};a.exports=function(){var a=c(null);return b.call(arguments,function(b){null!=b&&d(Object(b),a)}),a}},function(a){"use strict";a.exports=function(a){if("function"!=typeof a)throw new TypeError(a+" is not a function");return a}},function(a){"use strict";a.exports=function(a){if(null==a)throw new TypeError("Cannot use null or undefined");return a}},function(a){"use strict";a.exports=c(23)()?String.prototype.contains:c(24)},function(a){"use strict";var b="razdwatrzy";a.exports=function(){return"function"!=typeof b.contains?!1:b.contains("dwa")===!0&&b.contains("foo")===!1}},function(a){"use strict";var b=String.prototype.indexOf;a.exports=function(a){return b.call(this,a,arguments[1])>-1}},function(b){b.exports=a},function(a){a.exports=b},function(a){function b(a,b){var c=-1,e=a?a.length:0,f={};for(!e||b||d(a[0])||(b=[]);++c<e;){var g=a[c];b?f[g]=b[c]:g&&(f[g[0]]=g[1])}return f}var d=c(50);a.exports=b},function(a){function b(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}a.exports=b},function(a){function b(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}a.exports=b},function(a){function b(a,b,c){var f=e(b);if(!c)return d(b,a,f);for(var g=-1,h=f.length;++g<h;){var i=f[g],j=a[i],k=c(j,b[i],i,a,b);(k===k?k===j:j!==j)&&("undefined"!=typeof j||i in a)||(a[i]=k)}return a}var d=c(32),e=c(55);a.exports=b},function(a){function b(a,c,o,p,q,r,t){var u;if(o&&(u=q?o(a,p,q):o(a)),"undefined"!=typeof u)return u;if(!l(a))return a;var w=k(a);if(w){if(u=h(a),!c)return d(a,u)}else{var x=M.call(a),y=x==s;if(x!=v&&x!=n&&(!y||q))return K[x]?i(a,x,c):q?a:{};if(u=j(y?{}:a),!c)return f(a,u,m(a))}r||(r=[]),t||(t=[]);for(var z=r.length;z--;)if(r[z]==a)return t[z];return r.push(a),t.push(u),(w?e:g)(a,function(d,e){u[e]=b(d,c,o,e,a,r,t)}),u}var d=c(28),e=c(29),f=c(32),g=c(34),h=c(39),i=c(40),j=c(41),k=c(50),l=c(52),m=c(55),n="[object Arguments]",o="[object Array]",p="[object Boolean]",q="[object Date]",r="[object Error]",s="[object Function]",t="[object Map]",u="[object Number]",v="[object Object]",w="[object RegExp]",x="[object Set]",y="[object String]",z="[object WeakMap]",A="[object ArrayBuffer]",B="[object Float32Array]",C="[object Float64Array]",D="[object Int8Array]",E="[object Int16Array]",F="[object Int32Array]",G="[object Uint8Array]",H="[object Uint8ClampedArray]",I="[object Uint16Array]",J="[object Uint32Array]",K={};K[n]=K[o]=K[A]=K[p]=K[q]=K[B]=K[C]=K[D]=K[E]=K[F]=K[u]=K[v]=K[w]=K[y]=K[G]=K[H]=K[I]=K[J]=!0,K[r]=K[s]=K[t]=K[x]=K[z]=!1;var L=Object.prototype,M=L.toString;a.exports=b},function(a){function b(a,b,c){c||(c=b,b={});for(var d=-1,e=c.length;++d<e;){var f=c[d];b[f]=a[f]}return b}a.exports=b},function(a){function b(a,b,c){for(var e=-1,f=d(a),g=c(a),h=g.length;++e<h;){var i=g[e];if(b(f[i],i,f)===!1)break}return a}var d=c(47);a.exports=b},function(a){function b(a,b){return d(a,b,e)}var d=c(33),e=c(55);a.exports=b},function(a){function b(a){return"string"==typeof a?a:null==a?"":a+""}a.exports=b},function(a){function b(a,b,c){if("function"!=typeof a)return d;if("undefined"==typeof b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}var d=c(60);a.exports=b},function(a){function b(a){return h.call(a,0)}var e=c(59),f=c(51),g=f(g=d.ArrayBuffer)&&g,h=f(h=g&&new g(0).slice)&&h,i=Math.floor,j=f(j=d.Uint8Array)&&j,k=function(){try{var a=f(a=d.Float64Array)&&a,b=new a(new g(10),0,1)&&a}catch(c){}return b}(),l=k?k.BYTES_PER_ELEMENT:0;h||(b=g&&j?function(a){var b=a.byteLength,c=k?i(b/l):0,d=c*l,e=new g(b);if(c){var f=new k(e,0,c);f.set(new k(a,0,c))}return b!=d&&(f=new j(e,d),f.set(new j(a,d))),e}:e(null)),a.exports=b},function(a){function b(a){return function(){var b=arguments.length,c=arguments[0];if(2>b||null==c)return c;if(b>3&&e(arguments[1],arguments[2],arguments[3])&&(b=2),b>3&&"function"==typeof arguments[b-2])var f=d(arguments[--b-1],arguments[b--],5);else b>2&&"function"==typeof arguments[b-1]&&(f=arguments[--b]);for(var g=0;++g<b;){var h=arguments[g];h&&a(c,h,f)}return c}}var d=c(36),e=c(43);a.exports=b},function(a){function b(a){var b=a.length,c=new a.constructor(b);return b&&"string"==typeof a[0]&&d.call(a,"index")&&(c.index=a.index,c.input=a.input),c}var c=Object.prototype,d=c.hasOwnProperty;a.exports=b},function(a){function b(a,b,c){var u=a.constructor;switch(b){case j:return d(a);case e:case f:return new u(+a);case k:case l:case m:case n:case o:case p:case q:case r:case s:var v=a.buffer;return new u(c?d(v):v,a.byteOffset,a.length);case g:case i:return new u(a);case h:var w=new u(a.source,t.exec(a));w.lastIndex=a.lastIndex}return w}var d=c(37),e="[object Boolean]",f="[object Date]",g="[object Number]",h="[object RegExp]",i="[object String]",j="[object ArrayBuffer]",k="[object Float32Array]",l="[object Float64Array]",m="[object Int8Array]",n="[object Int16Array]",o="[object Int32Array]",p="[object Uint8Array]",q="[object Uint8ClampedArray]",r="[object Uint16Array]",s="[object Uint32Array]",t=/\w*$/;a.exports=b},function(a){function b(a){var b=a.constructor;return"function"==typeof b&&b instanceof b||(b=Object),new b}a.exports=b},function(a){function b(a,b){return a=+a,b=null==b?c:b,a>-1&&a%1==0&&b>a}var c=Math.pow(2,53)-1;a.exports=b},function(a){function b(a,b,c){if(!f(c))return!1;var g=typeof b;if("number"==g)var h=c.length,i=e(h)&&d(b,h);else i="string"==g&&b in c;var j=c[b];return i&&(a===a?a===j:j!==j)}var d=c(42),e=c(44),f=c(52);a.exports=b},function(a){function b(a){return"number"==typeof a&&a>-1&&a%1==0&&c>=a}var c=Math.pow(2,53)-1;a.exports=b},function(a){function b(a){return a&&"object"==typeof a||!1}a.exports=b},function(a){function b(a){for(var b=h(a),c=b.length,j=c&&a.length,l=j&&g(j)&&(e(a)||i.nonEnumArgs&&d(a)),m=-1,n=[];++m<c;){var o=b[m];(l&&f(o,j)||k.call(a,o))&&n.push(o)}return n}var d=c(49),e=c(50),f=c(42),g=c(44),h=c(56),i=c(58),j=Object.prototype,k=j.hasOwnProperty;a.exports=b},function(a){function b(a){return d(a)?a:Object(a)}var d=c(52);a.exports=b},function(a){function b(a,b,c,g){return b&&"boolean"!=typeof b&&f(a,b,c)?b=!1:"function"==typeof b&&(g=c,c=b,b=!1),c="function"==typeof c&&e(c,g,1),d(a,b,c)}var d=c(31),e=c(36),f=c(43);a.exports=b},function(a){function b(a){var b=e(a)?a.length:void 0;return d(b)&&h.call(a)==f||!1}var d=c(44),e=c(45),f="[object Arguments]",g=Object.prototype,h=g.toString;a.exports=b},function(a){var b=c(44),d=c(51),e=c(45),f="[object Array]",g=Object.prototype,h=g.toString,i=d(i=Array.isArray)&&i,j=i||function(a){return e(a)&&b(a.length)&&h.call(a)==f||!1};a.exports=j},function(a){function b(a){return null==a?!1:j.call(a)==f?k.test(i.call(a)):e(a)&&g.test(a)||!1}var d=c(57),e=c(45),f="[object Function]",g=/^\[object .+?Constructor\]$/,h=Object.prototype,i=Function.prototype.toString,j=h.toString,k=RegExp("^"+d(j).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=b},function(a){function b(a){var b=typeof a;return"function"==b||a&&"object"==b||!1}a.exports=b},function(a){var b=c(30),d=c(38),e=d(b);a.exports=e},function(a){a.exports=c(53)},function(a){var b=c(44),d=c(51),e=c(52),f=c(46),g=d(g=Object.keys)&&g,h=g?function(a){if(a)var c=a.constructor,d=a.length;return"function"==typeof c&&c.prototype===a||"function"!=typeof a&&d&&b(d)?f(a):e(a)?g(a):[]}:f;a.exports=h},function(a){function b(a){if(null==a)return[];h(a)||(a=Object(a));var b=a.length;b=b&&g(b)&&(e(a)||i.nonEnumArgs&&d(a))&&b||0;for(var c=a.constructor,j=-1,l="function"==typeof c&&c.prototype===a,m=Array(b),n=b>0;++j<b;)m[j]=j+"";for(var o in a)n&&f(o,b)||"constructor"==o&&(l||!k.call(a,o))||m.push(o);return m}var d=c(49),e=c(50),f=c(42),g=c(44),h=c(52),i=c(58),j=Object.prototype,k=j.hasOwnProperty;a.exports=b},function(a){function b(a){return a=d(a),a&&f.test(a)?a.replace(e,"\\$&"):a}var d=c(35),e=/[.*+?^${}()|[\]\/\\]/g,f=RegExp(e.source);a.exports=b},function(a){var b=c(51),e=/\bthis\b/,f=Object.prototype,g=(g=d.window)&&g.document,h=f.propertyIsEnumerable,i={};!function(){i.funcDecomp=!b(d.WinRTError)&&e.test(function(){return this}),i.funcNames="string"==typeof Function.name;try{i.dom=11===g.createDocumentFragment().nodeType}catch(a){i.dom=!1}try{i.nonEnumArgs=!h.call(arguments,1)}catch(a){i.nonEnumArgs=!0}}(0,0),a.exports=i},function(a){function b(a){return function(){return a}}a.exports=b},function(a){function b(a){return a}a.exports=b},function(a){(function(){var b,c,d;"undefined"!=typeof performance&&null!==performance&&performance.now?a.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(a.exports=function(){return(b()-d)/1e6},c=process.hrtime,b=function(){var a;return a=c(),1e9*a[0]+a[1]},d=b()):Date.now?(a.exports=function(){return Date.now()-d},d=Date.now()):(a.exports=function(){return(new Date).getTime()-d},d=(new Date).getTime())}).call(this)}],c(7)});